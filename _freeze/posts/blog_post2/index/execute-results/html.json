{
  "hash": "a7f36cfdd10a445682f56e8b4586e4cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Blog Post 2\"\nauthor: \"David Zuhlsdorf\"\ndate: \"2026-02-18\"\ncategories: [news, code, analysis]\n---\n\n### Introduction:\n\nIn this blog post, I will be looking at breweries across the United States. This data set is a csv file I got from my data folder from my Stat-234 class from last spring. Breweries vary in their type and region so those will be the variables I will look at. In this analysis I will look at the distribution of breweries across the United States while also looking at the distribution of different types. My main question will be: How do brewery counts and brewery types differ across U.S. states?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clean data and create a count\nbreweries <- read_csv(here::here(\"data/breweries.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 2407 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): brewery_name, type, address, website, state\ndbl (1): state_breweries\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nbrew_count <- breweries %>%\n  group_by(state) %>%\n  mutate(state = str_replace_all(state, \"-\", \" \")) %>%\n  summarize(total_breweries = n()\n            )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load map data and join\nstates_map <- map_data(\"state\")\nmap_df <- states_map %>%\n  left_join(brew_count, by = c(\"region\" = \"state\"))\n```\n:::\n\n\n### Figure 1. Map of total breweries by state\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make choropleth map showing total breweries in each state\nggplot(map_df, aes(long, lat, group = group,)) +\n  geom_polygon(aes(fill = total_breweries)) + \n  coord_fixed(1.3) +\n  scale_fill_distiller(type = \"seq\",palette = \"Reds\", direction = 1) +\n  theme_minimal() +\n  labs(title = \"Breweries by State\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nFrom the map, breweries are present across most states, but their distribution is uneven. A small number of states, particularly on the West Coast, in parts of the Northeast, and in Texas, show much higher concentrations of breweries compared to other regions. We can see that the west coast is the most heavily concentrated, along with Colorado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# top 10 states in breweries\nt10_state <- brew_count %>%\n  arrange(desc(total_breweries)) %>%\n  slice(1:10) %>%\n  mutate(state = fct_reorder(state,total_breweries))\n```\n:::\n\n\n### Figure 2. Lollipop plot of top 10 states in total breweries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(t10_state,aes(x = state, y = total_breweries)) +\n  geom_segment(aes(xend = state, y = 0, yend =  total_breweries),\n               color = \"hotpink\") +\n                 geom_point(color = \"hotpink\") +\n coord_flip() +\n  theme_minimal() +\n  labs(title = \"Lollipop plot of top 10 states in total breweries\",\n       x = \"Total Breweries\",\n       y = \"State\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThis is just a simple lollipop plot showing the top 10 states in total breweries. As we can see, the western states are leading the pack like we discussed above after looking at the map.\n\n### Figure 3. Grouped bar chart showing distribution of brewery types across the top 10 states\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clean data so we only have top 10 states and the top 3 types of breweries\nbreweries %>%\n  filter(state %in% c(\"california\",\"colorado\",\"oregon\", \"washington\",\"newyork\",\"pennsylvania\",\"florida\",\"michigan\",\"texas\",\"wisconsin\")) %>%\n  filter(type %in% c(\"Microbrewery\", \"Brewpub\",\"ContractBrewery\")) %>%\n  count(state, type)%>%\n  ggplot(aes(x = state, y = n, fill = type)) +\n  geom_col(position = \"dodge\") +\n  labs(title = \"Distribution of Brewery Types Across the Top 10 States\",\n       subtitle = \"Top 3 types of breweries\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThis grouped bar chart compares the number of brewpubs, microbreweries, and contract breweries across the top 10 U.S. states by total brewery count. Brewpubs are the most common brewery type in every state shown, while microbreweries consistently make up the second-largest share and contract breweries remain relatively rare. Although total brewery counts vary by state, the overall composition of brewery types is pretty consistent across these top states.\n\n### Conclusion:\n\nThis analysis shows that there are geographic patterns in the distribution of breweries across the United States, with higher concentration in states such as California, Colorado, and parts of the northeast. Looking beyond location, we can also see that Brew pubs dominate the industry. This suggests that producers prefer a brewery that is restaurant based and offers food rather than a brewery that just offers beer. This makes sense because people like to eat food while they drink beer, so this is most likely the most profitable avenue. I did encounter some limitations in my analysis. The type of brewery was not the cleanest, hence why I had to filter by the top 3 types. This was for time sake purposes. There were also some variables that were not useful and the amount of variables were limited. With additional data or more time, I would try to incorporate population, breweries per capita, climate, and proximity to resources. I feel like these variables could provide more insight.\n\n### Connection to Class:\n\nThis project uses concepts from class, specifically using visuals to provide deeper understanding. Rather than relying on summary statistics alone, visualizations such as choropleth maps and bar charts are used to reveal patterns, variation, and concentration in the data. These visuals make it easier to identify regional patterns and differences in brewery types that would be difficult to observe from a table of counts.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}